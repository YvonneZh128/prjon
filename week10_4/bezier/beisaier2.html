<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title></title>
    </head>
    <body>
        <canvas id="canvas" height="600" width="1000" style="border: 1px solid #000">

        </canvas>
    </body>
    <script type="text/javascript">
        var canvas = document.querySelector('#canvas');
        var paint = canvas.getContext('2d');
        paint.strokeStyle = '#000';
        paint.beginPath();

        var num = 4;

        var points = [];

        canvas.addEventListener('click', function(event) {
            var point = {x: event.offsetX, y: event.offsetY};

            if(points.length == 0) {
                paint.moveTo(point.x, point.y);
                paint.strokeStyle = '#000';
                paint.lineWidth = 1;
            }else {
                paint.lineTo(point.x, point.y);
                paint.stroke();
            }

            points.push(point);

            if(points.length >= num) {
                paint.moveTo(points[0].x, points[0].y);

                (function() {
                    var e = 1;
                    paint.beginPath();
                    paint.strokeStyle = '#f00';
                    paint.lineWidth = 2;
                    var lastE = points[0];

                    var timer = setInterval(function() {
                        var E = getPointE(e);

                        paint.beginPath();
                        paint.strokeStyle = '#f00';
                        paint.moveTo(lastE.x, lastE.y);
                        paint.lineTo(E.x, E.y);
                        paint.stroke();

                        e++;
                        lastE = E;
                        if(e > 100) {
                            console.log('draw complete');
                            clearInterval(timer);
                            points = [];
                            paint.beginPath();
                        }
                    }, 50);

                })();
            }
        });


        function getPointE(e) {
            e = e / 100;
            var me = 1 - e;

            var a = points[0];
            var b = points[1];
            var c = points[2];
            var d = points[3];

            var f = addPoint(getPoint(a, me), getPoint(b, e));
            var g = addPoint(getPoint(b, me), getPoint(c, e));
            var h = addPoint(getPoint(c, me), getPoint(d, e));

            var i = addPoint(getPoint(f, me), getPoint(g, e));
            var j = addPoint(getPoint(g, me), getPoint(h, e));

            var E = addPoint(getPoint(i, me), getPoint(j, e));
            return E;
        }
        function addPoint(pointA, pointB) {
            return {x: pointA.x+pointB.x, y: pointA.y+pointB.y};
        }
        function getPoint(point, e) {
            return {x: point.x*e, y: point.y*e};
        }

    </script>
</html>
